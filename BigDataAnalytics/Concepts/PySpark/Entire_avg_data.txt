Microsoft Windows [Version 10.0.22631.4317]
(c) Microsoft Corporation. All rights reserved.

C:\Users\aparn>cd C:\spark\spark-3.5.3-bin-hadoop3\bin

C:\spark\spark-3.5.3-bin-hadoop3\bin>pyspark
Python 3.12.7 (tags/v3.12.7:0b05ead, Oct  1 2024, 03:06:41) [MSC v.1941 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /__ / .__/\_,_/_/ /_/\_\   version 3.5.3
      /_/

Using Python version 3.12.7 (tags/v3.12.7:0b05ead, Oct  1 2024 03:06:41)
Spark context Web UI available at http://10.250.200.114:4040
Spark context available as 'sc' (master = local[*], app id = local-1731449737690).
SparkSession available as 'spark'.
>>> from pyspark.sql.types import *
>>> sch = StructType([
...     StructField("date", StringType(), False),
...     StructField("delay", IntegerType(), False),
...     StructField("distance", IntegerType(), False),
...     StructField("origin", StringType(), False),
...     StructField("destination", StringType(), False)
... ])
>>> df = spark.read.csv('departuredelays.csv', header=True, schema=sch)
>>> df_sj=df.filter(df["destination"]=="SJC")
>>> from pyspark.sql.functions import avg
>>> df_delay=df.groupBy('origin').agg(avg('delay').alias('avg_delay'))
>>> df_delay.show()
+------+-------------------+
|origin|          avg_delay|
+------+-------------------+
|   BUR|  8.316794644615081|
|   EUG|  7.568056648308419|
|   BTM|-0.7666666666666667|
|   COD|  2.374301675977654|
|   FAR| 15.780968006562757|
|   FSM|  4.881666666666667|
|   DCA|  8.012508036705828|
|   CID|  16.57703927492447|
|   EVV| 11.860088365243005|
|   CRW| 11.121693121693122|
|   CDV| -5.752808988764045|
|   CMH| 14.022459893048127|
|   CAK|  8.965957446808511|
|   CHO|  8.016556291390728|
|   CEC|  11.60655737704918|
|   CVG| 11.397058823529411|
|   BUF|  12.44192439862543|
|   CDC|0.33116883116883117|
|   ACT|  0.897025171624714|
|   AUS| 10.835627368841013|
+------+-------------------+
only showing top 20 rows

>>> df_delay.count()
255
>>> df_delay.show(255)
+------+--------------------+
|origin|           avg_delay|
+------+--------------------+
|   BUR|   8.316794644615081|
|   EUG|   7.568056648308419|
|   BTM| -0.7666666666666667|
|   COD|   2.374301675977654|
|   FAR|  15.780968006562757|
|   FSM|   4.881666666666667|
|   DCA|   8.012508036705828|
|   CID|   16.57703927492447|
|   EVV|  11.860088365243005|
|   CRW|  11.121693121693122|
|   CDV|  -5.752808988764045|
|   CMH|  14.022459893048127|
|   CAK|   8.965957446808511|
|   CHO|   8.016556291390728|
|   CEC|   11.60655737704918|
|   CVG|  11.397058823529411|
|   BUF|   12.44192439862543|
|   CDC| 0.33116883116883117|
|   ACT|   0.897025171624714|
|   AUS|  10.835627368841013|
|   ATW|  14.175652173913043|
|   DHN|    6.95575221238938|
|   AVL|   8.158119658119658|
|   BFL|   4.682188591385332|
|   EYW|    5.28926282051282|
|   CHS|  10.837381203801478|
|   AMA|  11.810317033852767|
|   BOS|    9.41305033927726|
|   EWR|  16.372251952560024|
|   BIS|   8.443708609271523|
|   FAI|   -2.95935960591133|
|   DLH|  13.498542274052479|
|   DEN|  16.922668773989614|
|   ALB|  11.415007656967841|
|   CPR|  3.1090225563909772|
|   BOI|    7.13029702970297|
|   BRO|   8.142622950819671|
|   DRO|   8.957720588235293|
|   BMI|  11.361918604651162|
|   CMI|  15.618444846292947|
|   BNA|  15.454962499089783|
|   CLL|   3.463595839524517|
|   CLT|   8.681008379691571|
|   CIC|  13.996282527881041|
|   ABQ|  11.225300575013069|
|   ACV|  10.989569752281616|
|   BDL|  10.232497192062898|
|   DAL|  15.099272533711853|
|   DBQ|   7.620915032679738|
|   CLE|  14.035917207792208|
|   BWI|  16.831106781705166|
|   BRW|  3.8427947598253276|
|   ABI|   7.263456090651558|
|   ELM|   9.442028985507246|
|   FCA|   6.889705882352941|
|   ABY|   6.166666666666667|
|   BET|  -2.665289256198347|
|   ABE|  11.412946428571429|
|   DFW|   9.918650156245437|
|   FAY|   13.92294220665499|
|   EKO| -0.0860655737704918|
|   CRP|   6.816365979381444|
|   EGE|   20.57012542759407|
|   FSD|  13.583533653846153|
|   BQK|    15.8714859437751|
|   CSG|   7.628398791540786|
|   ELP|    9.34094655050624|
|   BHM|  13.485861964122833|
|   ATL|  12.582385990992961|
|   FLL|  16.514384094190824|
|   FNT|   9.988786952089704|
|   DAY|               11.25|
|   BPT|   7.533073929961089|
|   CAE|  15.047451669595782|
|   FAT|   8.853170189098998|
|   AVP|  11.244274809160306|
|   BTV|    18.7246192893401|
|   AEX|  11.609339407744875|
|   BIL|  3.4151436031331595|
|   BQN|  11.597058823529412|
|   AZO|  1.4746835443037976|
|   COS|  11.949350067234423|
|   ALO|  17.161676646706585|
|   CHA|   8.391592920353983|
|   DTW|  13.040689979078605|
|   ADQ| -1.9242424242424243|
|   BGR|  14.331658291457286|
|   BTR|  10.377064653138273|
|   AGS|  6.9102209944751385|
|   BZN|   8.211363636363636|
|   ANC|  1.3623348017621146|
|   DAB|  11.473551637279597|
|   DSM|   15.08490188225871|
|   CLD|   8.016611295681063|
|   MSY|   11.80762868541403|
|   GEG|   6.068493150684931|
|   GRB|     8.4463480613165|
|   GTF|   4.741176470588235|
|   IDA|   3.565749235474006|
|   GRR|  15.304448742746615|
|   GSO|  13.494742376445846|
|   MYR|   7.859007832898173|
|   OAK|  12.790245362058647|
|   MQT|   23.87012987012987|
|   MSN|   9.361593895718524|
|   GTR|              14.064|
|   MLU|    7.91254752851711|
|   HLN| -0.7884615384615384|
|   LEX|  13.837308347529813|
|   ORF|  12.902831177909821|
|   KTN|  1.9055555555555554|
|   MOD|   9.933333333333334|
|   MOB|  11.688118811881187|
|   LIH|-0.25077639751552794|
|   IAH|   13.56006549664445|
|   HNL|  2.7074607923125735|
|   LGA|  11.936837143530521|
|   HPN|  14.065278559369725|
|   MLI|  13.699604743083004|
|   GJT|  2.4332939787485244|
|   LGB|   5.369833212472806|
|   GFK|  -5.333333333333333|
|   JAC|  13.025490196078431|
|   HRL|  11.346153846153847|
|   ISP|  17.697810218978102|
|   MAF|   8.306545153272577|
|   MLB|  10.227665706051873|
|   LAS|   13.34451928595161|
|   ITO|  -2.375753516409913|
|   JAN|   9.274482109227872|
|   LNK|   17.02007299270073|
|   OME| -0.4576271186440678|
|   IAD|   18.40343803056027|
|   LAN|  16.147435897435898|
|   LRD|   6.329896907216495|
|   MCI|  13.084049930651872|
|   LAW|-0.31301939058171746|
|   MRY|   5.785245901639344|
|   MFR|  12.839240506329114|
|   MIA|   7.763349681441078|
|   OKC|   11.77710233029382|
|   MBS|   3.211764705882353|
|   MHT|  13.312093628088427|
|   GSP|  11.846196868008949|
|   LSE|  26.532467532467532|
|   HDN|   7.473180076628353|
|   GUC|   17.73061224489796|
|   LBB|   7.254569190600522|
|   MEM|  11.238605898123325|
|   OMA|  10.281224322103533|
|   LCH|   6.359223300970874|
|   LIT|  10.282945736434108|
|   ICT|  10.930510814542108|
|   ORD|  18.588917606028524|
|   ILM|     8.5748031496063|
|   GUM|   33.87777777777778|
|   MFE|   8.957142857142857|
|   MKE|  13.468443893366398|
|   HSV|  10.076732673267326|
|   LFT|   6.643461288223812|
|   MTJ|  13.759856630824373|
|   MDW|  19.657658556043078|
|   OAJ|   12.08974358974359|
|   JNU|  2.5028248587570623|
|   IND|  13.806931407942239|
|   KOA|   1.470079036507339|
|   GPT|  10.097050428163653|
|   MGM|   7.605381165919282|
|   HOU|   14.95943012211669|
|   FWA|  11.285062713797036|
|   MDT|  12.425047438330171|
|   ONT|   8.740960163432074|
|   JAX|    10.9952770208901|
|   LAX|   10.45538586695263|
|   MOT|  11.112244897959183|
|   MSP|  10.435645624401815|
|   MCO|   15.71963409034719|
|   GGG|  3.1944444444444446|
|   JFK|  16.457194977091465|
|   GNV|     8.4328165374677|
|   MSO|   7.244956772334294|
|   OGG|   1.463062716429396|
|   SNA|   8.639889491021146|
|   PSG|               -0.25|
|   PVD|  10.625215889464593|
|   SCC| -1.5240174672489082|
|   WRG|                -2.5|
|   RDM|   4.338790931989925|
|   SCE|   17.91616766467066|
|   SAV|  12.739905610907185|
|   TRI|  6.6716417910447765|
|   TYR|  3.5673222390317703|
|   PNS|   7.384343434343434|
|   SHV|  15.477272727272727|
|   SJC|   8.695464806074288|
|   TOL|   5.729957805907173|
|   TLH|   11.35269000853971|
|   RDD|  13.059259259259258|
|   SJU|  14.286952688803996|
|   RNO|   8.746494066882416|
|   SRQ|   16.41780821917808|
|   SBN|   9.228052472250253|
|   RST|   7.302083333333333|
|   RSW|  12.856248009342817|
|   TUL|   10.91796624652852|
|   XNA|  12.249515691592405|
|   SGU|   3.272935779816514|
|   PSP|  13.122677595628415|
|   SBA|   8.415126050420168|
|   SEA|   6.893404974434526|
|   VLD|  10.268774703557312|
|   TVC|  10.051724137931034|
|   PSC|  1.5232744783306582|
|   PBI|  16.555021895747988|
|   SDF|  13.139555295494441|
|   PDX|    6.68213205058577|
|   TWF|  -1.344311377245509|
|   TPA|  14.105069070475299|
|   ROA|  19.885106382978723|
|   SMF|   9.635140602872749|
|   PHX|   9.067936745112688|
|   PWM|  11.488847583643123|
|   STL|  14.588865096359743|
|   TXK|  1.6303501945525292|
|   STX|   6.589641434262949|
|   SWF|  13.688888888888888|
|   SUN|   7.322884012539185|
|   SFO|  12.705974723298635|
|   PIH|  2.9419087136929463|
|   RIC|   11.35657894736842|
|   PHF|  12.163385826771654|
|   SJT|   4.137299771167048|
|   VPS|  10.090219224283306|
|   SPS|  4.0584958217270195|
|   SMX|   4.596091205211726|
|   PIA|   14.19284064665127|
|   RDU|  10.443147154728095|
|   SYR|  15.384870603848706|
|   PIT|    8.60100791936645|
|   TUS|    8.36010182828049|
|   TYS|  13.167606355715018|
|   YUM|   2.047682119205298|
|   SIT|   8.769516728624536|
|   OTZ| -2.8813559322033897|
|   ROC|  14.521798990362552|
|   SGF|  15.780621572212066|
|   SAN|  10.951957789502917|
|   YAK|  -6.685393258426966|
|   SUX|   8.868263473053892|
|   PHL|  13.309838879353302|
|   SAT|   9.560735150925025|
|   SLC|   6.222668934591001|
|   STT|  11.626080125687352|
|   RAP|   9.111929307805596|
|   SBP|   9.388591800356506|
+------+--------------------+

>>>
